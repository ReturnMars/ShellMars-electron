# 项目执行待办拆解（详细版）

> 任务按照“里程碑 → 模块 → 步骤”逐层拆解。表格中可根据实际情况补充负责人、计划时间、状态等信息；如无特别说明，状态默认为“未开始”。

---

## 里程碑 M0：预研与底座搭建（2 周）

### M0-A 环境与规范

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M0-A1 | 无 | 创建 Git 仓库、初始化 `package.json`、设置 pnpm/yarn | 仓库可拉取、依赖安装成功 | 初始仓库 |
| M0-A2 | M0-A1 | 安装并配置 `electron-vite` 脚手架，拆分 main/preload/renderer | `pnpm dev` 启动成功，控制台无报错 | 基础工程骨架 |
| M0-A3 | M0-A2 | 引入 TypeScript、别名、路径校验，配置 `tsconfig` | TS 编译通过，别名可用 | TypeScript 配置 |
| M0-A4 | M0-A1 | 配置 Oxlint + Prettier + Husky + lint-staged | `pnpm lint`、`pnpm format` 正常，提交钩子生效 | 代码规范套件 |
| M0-A5 | M0-A2 | 建立中文编码规范、Commit 模版、PR 流程文档 | 团队约定文档上线 | 团队规范文档 |

### M0-B 架构验证

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M0-B1 | M0-A2 | 编写主进程示例，创建窗口并引入 preload | 窗口加载成功，preload 执行 | 基础窗口样例 |
| M0-B2 | M0-B1 | 在 preload 中通过 `contextBridge` 暴露 `ping` API | 渲染层调用返回 `pong` | IPC Demo |
| M0-B3 | M0-B2 | 在渲染层（Vue）调用 API，展示结果 | 页面显示 ping-pong 信息 | Hello World Demo |

### M0-C 原生依赖调研

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M0-C1 | M0-A2 | 在各平台安装编译工具链（Windows VS Build Tools、macOS Xcode CLI、Linux build-essential） | 环境检测脚本通过 | 工具链安装记录 |
| M0-C2 | M0-C1 | 尝试编译 `node-pty`、`ssh2`，记录报错与解决方案 | 三平台构建成功或有明确 workaround | 原生依赖报告 |
| M0-C3 | M0-C2 | 配置 `electron-rebuild`，编写编译脚本 | `pnpm rebuild` 成功 | rebuild 脚本 |

---

## 里程碑 M1：最小可用终端（4 周）

### M1-A Session 管理模块

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M1-A1 | M0 完成 | 定义 `SessionManager` 接口、会话数据结构、事件流 | 设计文档评审通过 | Session 设计稿 |
| M1-A2 | M1-A1 | 集成 `ssh2`，实现 SSH 连接/断开、认证（密码/密钥） | 可连 Linux 测试机并执行 `whoami` | Session 模块 |
| M1-A3 | M1-A2 | 管理会话池，支持多连接、心跳、异常重连策略 | 并发 5 个会话稳定运行 | 会话池实现 |
| M1-A4 | M1-A2 | 编写模块单元测试、模拟连接失败场景 | 覆盖率达标（>70%），用例通过 | Session 测试 |

### M1-B PTY 与终端链路

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M1-B1 | M1-A2 | 使用 `node-pty` 创建伪终端绑定 SSH 流 | 输入命令回显正确 | PTY 适配层 |
| M1-B2 | M1-B1 | 设计主进程终端事件（data/error/exit），规范数据格式 | IPC 事件文档 | 事件协议 |
| M1-B3 | M1-B1 | 支持窗口大小调整、编码处理、流量控制 | 终端 resize 后服务端正确响应 | PTY 能力增强 |

### M1-C IPC 与预加载

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M1-C1 | M1-B2 | 在 `preload` 中暴露终端 API：`createSession`、`send`、`onData` | 渲染层可调用，类型提示完整 | 终端 API |
| M1-C2 | M1-C1 | 引入数据校验（`zod`/`io-ts`），过滤异常输入 | 无效参数能拒绝并给出错误信息 | IPC 校验逻辑 |
| M1-C3 | M1-C1 | 建立 IPC 错误与日志捕获机制 | 错误被记录且不崩溃 | IPC 守护方案 |

### M1-D 渲染层终端 UI

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M1-D1 | M1-C1 | 集成 `@xterm/xterm`，完成容器挂载 | 终端组件渲染成功 | 终端基础组件 |
| M1-D2 | M1-D1 | 实现多标签页、分屏布局、会话切换状态 | 多终端并行切换无异常 | 终端布局 |
| M1-D3 | M1-D2 | 增加快捷键（复制粘贴、全屏、清屏）、主题切换 | 快捷键可配置，深浅色切换 | UI 增强方案 |

### M1-E 状态管理与错误提示

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M1-E1 | M1-C1 | 建立 `pinia` Store 保存会话列表、当前会话 ID、连接状态 | 状态变化驱动 UI 更新 | 状态仓库 |
| M1-E2 | M1-E1 | 集成通知条/弹窗组件，统一处理错误与提示 | 会话异常时展示友好提示 | 通知中心 |
| M1-E3 | M1-E1 | 编写状态层单元测试与组件快照测试 | 测试覆盖率满足阈值 | 状态测试报告 |

---

## 里程碑 M2：文件管理与配置中心（4 周）

### M2-A SFTP 与文件操作

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M2-A1 | M1 完成 | 集成 `ssh2-sftp-client`，实现目录列表、文件属性读取 | 获取远程目录成功 | SFTP 基础功能 |
| M2-A2 | M2-A1 | 实现上传、下载、进度回调、断点续传 | 100MB 文件传输成功且可续传 | 传输模块 |
| M2-A3 | M2-A2 | 封装批量操作（移动、删除、权限修改） | 批量任务执行成功 | 文件操作 API |
| M2-A4 | M2-A2 | 构建传输任务队列、状态机 | UI 展示任务进度与历史 | 任务队列模块 |

### M2-B 文件管理 UI

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M2-B1 | M2-A1 | 设计双栏/树状文件浏览组件，支持面包屑导航 | UI 设计稿通过评审 | 设计稿 |
| M2-B2 | M2-B1 | 开发文件列表、右键菜单、拖拽上传 | 功能测试覆盖常见场景 | 文件管理器 |
| M2-B3 | M2-B2 | 整合传输队列、任务提示，支持失败重试 | 界面上可重试失败任务 | 传输面板 |

### M2-C 在线编辑与预览

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M2-C1 | M2-A1 | 集成 `monaco-editor`，支持语法高亮、行号、快捷键 | 本地打开文件正常 | 编辑器组件 |
| M2-C2 | M2-C1 | 实现远程文件加载、保存、冲突处理（提示覆盖） | 并发编辑时给出提醒 | 远程编辑流程 |
| M2-C3 | M2-C2 | 支持常见文本/日志预览、差异比较 | 可查看日志流、简单 diff | 预览功能 |

### M2-D 配置中心与安全

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M2-D1 | M1 完成 | 设计连接模板、凭证、偏好设置的数据模型 | 数据字典通过评审 | 数据模型 |
| M2-D2 | M2-D1 | 集成 `keytar` 保存私钥/密码，使用 SQLite/Nedb 持久化 | 凭证加密存储成功 | 配置存储模块 |
| M2-D3 | M2-D2 | 实现配置导入导出、重置、同步准备接口 | 可导出加密配置包 | 配置管理界面 |
| M2-D4 | M2-D2 | 编写安全策略文档（账户、权限、日志留存） | 文档评审通过 | 安全策略 |

### M2-E 自动测试体系

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M2-E1 | M2-A,B | 编写 SFTP、文件模块单元测试、模拟失败场景 | 覆盖率达80% | 单元测试集 |
| M2-E2 | M2-B3 | 基于 Playwright 开发文件操作 E2E 测试 | 自动化脚本可复用 | E2E 测试脚本 |
| M2-E3 | M2-C3 | 建立 CI 流程，接入测试报告（HTML、控制台） | CI 报告可视化 | CI 配置 |

---

## 里程碑 M3：运维能力扩展（5 周）

### M3-A 任务编排与脚本中心

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M3-A1 | M2 完成 | 设计批量任务 DSL/配置格式，支持参数化 | DSL 文档通过评审 | 任务 DSL |
| M3-A2 | M3-A1 | 实现命令执行引擎，支持串行/并行、错误回滚策略 | 可执行多台主机批量命令 | 任务执行器 |
| M3-A3 | M3-A2 | 集成定时任务（`cron`），提供任务历史、日志 | 定时执行可追踪 | Cron 管理界面 |
| M3-A4 | M3-A2 | 构建脚本模板库、导入导出功能 | 模板可复用、分享 | 脚本中心 |

### M3-B 监控与告警面板

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M3-B1 | M2 完成 | 选定指标采集方式（agent/命令采集/APIs），定义数据结构 | 指标方案评审通过 | 监控方案 |
| M3-B2 | M3-B1 | 实现指标订阅、阈值配置、实时刷新 | 3 秒刷新无明显卡顿 | 指标采集模块 |
| M3-B3 | M3-B2 | 使用 `echarts` 绘制图表、趋势、告警提示 | 图表交互顺畅 | 监控面板 UI |
| M3-B4 | M3-B2 | 构建告警规则、关联通知系统 | 告警可推送到通知中心 | 告警系统 |

### M3-C 日志审计与会话回放

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M3-C1 | M1 完成 | 设计审计数据模型（命令、文件、连接、用户） | 模型评审通过 | 审计设计 |
| M3-C2 | M3-C1 | 实现终端会话录像（ANSI 流保存）、文件操作留痕 | 可回放终端操作 | 审计采集模块 |
| M3-C3 | M3-C2 | 建立查询/过滤/导出界面，支持关键字、时间范围 | 审计界面上线 | 审计控制台 |
| M3-C4 | M3-C3 | 输出合规报告模板（导出 PDF/CSV） | 模板符合合规要求 | 报告模板 |

### M3-D 通知与用户体验

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M3-D1 | M2 完成 | 搭建通知中心，支持桌面提醒、系统托盘消息 | 通知可按类型归类 | 通知中心 |
| M3-D2 | M3-D1 | 集成可选邮件/Webhook 推送、频控策略 | 推送成功并可限流 | 外部通知模块 |
| M3-D3 | M1-D3 | 增强终端 UX（快捷键自定义、命令片段库、搜索） | 用户测试满意度达预期 | UX 优化报告 |

### M3-E 插件系统预研

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M3-E1 | M2 完成 | 设计 `PluginHost` 架构、扩展点、权限控制 | 设计评审通过 | 插件架构文档 |
| M3-E2 | M3-E1 | 实现示例插件（如快捷脚本面板），验证生命周期 | 插件可启用/禁用 | 插件 PoC |
| M3-E3 | M3-E2 | 编写插件开发指南、打包规范 | 说明文档上线 | 插件文档 |

---

## 里程碑 M4：交付准备与发布（4 周）

### M4-A 自动更新与安装分发

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M4-A1 | M3 完成 | 配置 `electron-updater`，搭建更新服务（私有/云） | DEV 环境可完成自更新 | 更新服务 |
| M4-A2 | M4-A1 | 生成 Win（exe/msi）、macOS（dmg/pkg）、Linux（AppImage/deb/rpm）安装包 | 三平台安装通过 | 安装制品 |
| M4-A3 | M4-A2 | 完成代码签名、公证（macOS notarization、Windows SignTool） | 签名验证通过 | 签名证书记录 |

### M4-B 性能与稳定性

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M4-B1 | M3 完成 | 建立性能基准：终端延迟、文件传输速率、内存占用 | 基准报告发布 | 性能基线 |
| M4-B2 | M4-B1 | 定位性能瓶颈，进行代码优化、异步调度、lazy load | 指标提升达标 | 优化方案 |
| M4-B3 | M4-B1 | 运行稳定性测试（长时间会话、网络波动） | 72 小时稳定运行 | 稳定性报告 |

### M4-C QA 与文档交付

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M4-C1 | 全量完成 | 制定 QA 测试用例、执行全链路测试 | 缺陷清单收敛 | QA 用例集 |
| M4-C2 | M4-C1 | 修复高优缺陷，完成回归测试 | 回归通过，缺陷关闭 | 回归报告 |
| M4-C3 | M4-C1 | 输出用户手册、部署指南、FAQ、发布公告模板 | 文档可供用户查阅 | 文档套件 |
| M4-C4 | M4-C3 | 制定发布流程、灰度策略、回滚预案 | 发布 Checklist | 发布指引 |

---

## 里程碑 M5：长期演进（持续迭代）

### M5-A 云端协同

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M5-A1 | M4 完成 | 设计账号体系、配置同步协议、冲突策略 | 方案评审通过 | 协同设计 |
| M5-A2 | M5-A1 | 实现云端存储服务、客户端同步 SDK | 多端配置一致 | 云同步服务 |
| M5-A3 | M5-A2 | 支持标签共享、会话共享、权限控制 | 协作功能上线 | 协作模块 |

### M5-B AI 运维助手

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M5-B1 | M4 完成 | 选型模型/服务，确定使用场景（命令推荐、日志诊断） | AI 方案评审 | AI 方案 |
| M5-B2 | M5-B1 | 开发 API 集成、提示词模板、上下文采集 | POC 演示可用 | AI POC |
| M5-B3 | M5-B2 | 设计安全策略（数据脱敏、权限控制） | 安全审查通过 | AI 安全文档 |

### M5-C 插件生态与企业特性

| 步骤 | 前置 | 任务说明 | 验收标准 | 输出 |
| --- | --- | --- | --- | --- |
| M5-C1 | M3-E3 | 建立插件商店/市场、审核流程、版本管理 | 插件管理后台 | 插件市场 |
| M5-C2 | M5-C1 | 扩展企业特性（RBAC、审计导出、资产管理对接） | 企业客户验收 | 企业特性模块 |
| M5-C3 | M5-C2 | 支持更多协议（RDP/K8s/串口）、硬件集成 | 协议测试通过 | 协议扩展包 |

---

### 使用说明
- 每个步骤应明确负责人、计划起止时间、当前状态（未开始/进行中/阻塞/完成）。
- 建议同步在项目管理工具中创建对应任务，以便跟踪依赖与燃尽图。
- 如任务拆解需进一步细化，可在对应步骤下追加子任务编号（如 M1-A2-1）。
- 文档更新时请注明版本号与更新时间，确保团队成员使用最新清单。


